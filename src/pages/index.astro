---
import Hero from "../components/Hero.astro";
import Headroom from "../components/Headroom.astro";
import Section from "../components/Section.astro";
import About from "../components/About.astro";
import Footer from "../components/Footer.astro";
import MainHead from "../components/MainHead.astro";

const blogsMd = await Astro.glob("./blog/*.md");
const allData = blogsMd.sort((a, b) => {
  const dateA = new Date(a?.frontmatter.date ?? "").getTime();
  const dateB = new Date(b?.frontmatter.date ?? "").getTime();

  return dateB - dateA;
});

const contentMd = await Astro.glob("../content/*.md");
const projects = contentMd.sort((a, b) => {
  if (a.order < b.order) {
    return -1;
  }
  if (a.order > b.order) {
    return 1;
  }
  return 0;
});

const articles = allData.filter(
  ({ frontmatter }) => frontmatter.type === "article"
);
const experiments = allData.filter(
  ({ frontmatter }) => frontmatter.type === "experiments"
);
---

<html lang="en">
  <head>
    <MainHead />
  </head>

  <body>
    <input class="debug" type="checkbox" id="debug" />
    <label for="debug" class="type_footnote">Debug</label>

    <input class="mode" type="checkbox" id="mode" />
    <label for="mode" class="type_footnote">Dark mode</label>

    <main>
      <div class="container grid">
        <Hero />
        <Headroom />

        <Section title="Writing" data={articles} />
        <Section title="Experiments" data={experiments} vertical />
        <Section title="Projects" data={projects} />

        <About />

        <Footer />
      </div>
    </main>
    <style lang="scss">
      .grid {
        padding-top: calc(var(--unit) * 1);
        padding-bottom: calc(var(--unit) * 1);
      }

      @media screen and (min-width: 800px) {
        .grid {
          padding-top: calc(var(--unit) * 8);
        }
      }

      .mode:checked {
        ~ main {
          --surface-0: rgba(253, 253, 255, 0.93);
          --surface-1: rgba(247, 245, 255, 0.616);
          --surface-2: rgba(240, 238, 255, 0.48);
          --surface-3: rgba(238, 236, 255, 0.416);
          --background: rgb(22, 22, 24);
          --highlight: #4e7bff29;
          --color-brand: #4e7bff;
        }
      }

      .debug {
      }

      .debug:checked {
        ~ .container {
          background: #c9debb !important;
          position: relative;

          :global(.grid) {
            position: relative;
          }

          &.grid:before,
          &.grid:after {
            content: "";
            display: block;
            background: #9593dd;
            width: var(--unit);
            position: absolute;
            margin: 0;
            top: calc(var(--unit) * 8);
            bottom: calc(var(--unit) * 1);
            outline: 1px dashed #7528ca;
            z-index: 999;

            background: repeating-linear-gradient(
                45deg,
                #8762d4 0px,
                #8762d4 1px,
                transparent 1px,
                transparent 9px
              )
              #9693de !important;
          }

          &.grid:before {
            left: calc(100% / 2.97 - var(--unit) / 2) !important;
          }

          &.grid:after {
            left: calc((100% / 3) * 2 - var(--unit) / 2) !important;
          }

          :global(.footer),
          :global(.hero),
          :global(.section) {
            outline: 1px dashed #7528ca;
            background: #a8c4e4 !important;
            position: relative;
          }

          :global(.section:after) {
            content: "";
            display: block;
            background: #9593dd;
            height: var(--unit);
            bottom: calc(var(--unit) * -1);
            position: absolute;
            left: 0;
            right: 0;
            outline: 1px dashed #7528ca;
            z-index: 999;

            background: repeating-linear-gradient(
                45deg,
                #8762d4 0px,
                #8762d4 1px,
                transparent 1px,
                transparent 9px
              )
              #9693de !important;
          }
        }
      }
    </style>
  </body>
</html>
